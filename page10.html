<html>
  <script src='https://d3js.org/d3.v5.min.js'></script>
  <script src="https://rawgit.com/susielu/d3-annotation/master/d3-annotation.min.js"></script>

  <style>
	body {background: #D1E4B6;}
	h1   {color: black;}
	svg    {border-radius: 25px; background: #73AD21; padding: 20px;}
	rect {fill: white; stroke: black; }
	path.line.annotation text {fill: white};
    }
  </style>
  <body>
	  <p>
    <input value="Slide 3" type="submit" onClick="myFunctionP1()"/>
	  <script>
		  function myFunctionP1() {
			  window.location.href="https://skel700.github.io/data-vis-final/page6";
		  }
	  </script>
	  
	  </p>
	</body>
  <body>
	  <p hidden id="ageRange">30 - 39</p>
        
	<form>
        <label for="ageRange">Choose an age range:</label>
        <select name="ageRange" id="ageRange">
          <option value="19 and Under">19 and Under</option>
          <option value="20 - 29">20 - 29</option>
          <option value="30 - 39">30 - 39</option>
          <option value="40 - 49">40 - 49</option>
          <option value="50 - 59">50 - 59</option>
          <option value="60 - 69">60 - 69</option>
          <option value="70 - 79">70 - 79</option>
          <option value="80 and Over">80 and Over</option>
        </select>
        <input type="submit" value="Submit" onClick="ageFxn()"/>
          <script>
          function ageFxn() {
            document.getElementById("ageRange").innerHTML = ageRange
          }
	  </script>
	  </form>
	</body>
  <body onload='init()'>
    <svg width=600 height=300></svg>

    <script>
	    
	    
	    var ageFields = ["19 and Under", "20 - 29", "30 - 39", "40 - 49", "50 - 59", "60 - 69", "70 - 79", "80 and Over"]
	    var categoryFields = ["Government Documents or Benefits Fraud", "Credit Card Fraud", "Other Identity Theft", "Loan or Lease Fraud", "Employment or Tax-Related Fraud", "Phone or Utilities Fraud", "Bank Fraud"]
	    
    async function init(){
    	data = d3.csv("/data-vis-final/Category_by_Age.csv")
			.then(function(data) {
		
		var ageMap = {};
		data.forEach(function(d) {
			var ages = d.Category;
			ageMap[ages] = [];
			
			typeFields.forEach(function(field) {
				ageMap[age].push( +d[field]);
			});
			makeVis(ageMap);
		});
		
		var makeVis = function(ageMap) {
			xs = d3.scaleBand().domain(typeFields).range([0, 400])
	    		ys = d3.scaleLinear().domain([0, 130000]).range([200, 0])
			
			d3.select("svg").append("g").attr("transform, "translate(100,50)").selectAll("rect").data(data).enter().append("rect").attr("x", function(d, i) {return xs(typeFields[i]);}).attr("y", function(d,i) {return ys(d);})
		};
        
        
          
		
		
function wrap(text, width) {
  text.each(function() {
    var text = d3.select(this),
        words = text.text().split(/\s+/).reverse(),
        word,
        line = [],
        lineNumber = 0,
        lineHeight = 1.1, // ems
        y = text.attr("y"),
        dy = parseFloat(text.attr("dy")),
        tspan = text.text(null).append("tspan").attr("x", 0).attr("y", y).attr("dy", dy + "em")
    while (word = words.pop()) {
      line.push(word)
      tspan.text(line.join(" "))
      if (tspan.node().getComputedTextLength() > width) {
        line.pop()
        tspan.text(line.join(" "))
        line = [word]
        tspan = text.append("tspan").attr("x", 0).attr("y", y).attr("dy", `${++lineNumber * lineHeight + dy}em`).text(word)
      }
    }
  })
	    };

        
		
		
	});
    }
    </script>
  </body>
	
</html>
